{"remainingRequest":"E:\\data\\git\\vue-admin\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\data\\git\\vue-admin\\vue-element-admin\\src\\views\\example\\components\\ArticleDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\data\\git\\vue-admin\\vue-element-admin\\src\\views\\example\\components\\ArticleDetail.vue","mtime":1636272798256},{"path":"E:\\data\\git\\vue-admin\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\data\\git\\vue-admin\\vue-element-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\data\\git\\vue-admin\\vue-element-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\data\\git\\vue-admin\\vue-element-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgVGlueW1jZSBmcm9tICdAL2NvbXBvbmVudHMvVGlueW1jZScNCmltcG9ydCBVcGxvYWQgZnJvbSAnQC9jb21wb25lbnRzL1VwbG9hZC9TaW5nbGVJbWFnZTMnDQppbXBvcnQgTURpbnB1dCBmcm9tICdAL2NvbXBvbmVudHMvTURpbnB1dCcNCmltcG9ydCBTdGlja3kgZnJvbSAnQC9jb21wb25lbnRzL1N0aWNreScgLy8g57KY5oCnaGVhZGVy57uE5Lu2DQppbXBvcnQgeyB2YWxpZFVSTCB9IGZyb20gJ0AvdXRpbHMvdmFsaWRhdGUnDQppbXBvcnQgeyBmZXRjaEFydGljbGUgfSBmcm9tICdAL2FwaS9hcnRpY2xlJw0KaW1wb3J0IHsgc2VhcmNoVXNlciB9IGZyb20gJ0AvYXBpL3JlbW90ZS1zZWFyY2gnDQppbXBvcnQgV2FybmluZyBmcm9tICcuL1dhcm5pbmcnDQppbXBvcnQgeyBDb21tZW50RHJvcGRvd24sIFBsYXRmb3JtRHJvcGRvd24sIFNvdXJjZVVybERyb3Bkb3duIH0gZnJvbSAnLi9Ecm9wZG93bicNCg0KY29uc3QgZGVmYXVsdEZvcm0gPSB7DQogIHN0YXR1czogJ2RyYWZ0JywNCiAgdGl0bGU6ICcnLCAvLyDmlofnq6Dpopjnm64NCiAgY29udGVudDogJycsIC8vIOaWh+eroOWGheWuuQ0KICBjb250ZW50X3Nob3J0OiAnJywgLy8g5paH56ug5pGY6KaBDQogIHNvdXJjZV91cmk6ICcnLCAvLyDmlofnq6DlpJbpk74NCiAgaW1hZ2VfdXJpOiAnJywgLy8g5paH56ug5Zu+54mHDQogIGRpc3BsYXlfdGltZTogdW5kZWZpbmVkLCAvLyDliY3lj7DlsZXnpLrml7bpl7QNCiAgaWQ6IHVuZGVmaW5lZCwNCiAgcGxhdGZvcm1zOiBbJ2EtcGxhdGZvcm0nXSwNCiAgY29tbWVudF9kaXNhYmxlZDogZmFsc2UsDQogIGltcG9ydGFuY2U6IDANCn0NCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAnQXJ0aWNsZURldGFpbCcsDQogIGNvbXBvbmVudHM6IHsgVGlueW1jZSwgTURpbnB1dCwgVXBsb2FkLCBTdGlja3ksIFdhcm5pbmcsIENvbW1lbnREcm9wZG93biwgUGxhdGZvcm1Ecm9wZG93biwgU291cmNlVXJsRHJvcGRvd24gfSwNCiAgcHJvcHM6IHsNCiAgICBpc0VkaXQ6IHsNCiAgICAgIHR5cGU6IEJvb2xlYW4sDQogICAgICBkZWZhdWx0OiBmYWxzZQ0KICAgIH0NCiAgfSwNCiAgZGF0YSgpIHsNCiAgICBjb25zdCB2YWxpZGF0ZVJlcXVpcmUgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7DQogICAgICBpZiAodmFsdWUgPT09ICcnKSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgIG1lc3NhZ2U6IHJ1bGUuZmllbGQgKyAn5Li65b+F5Lyg6aG5JywNCiAgICAgICAgICB0eXBlOiAnZXJyb3InDQogICAgICAgIH0pDQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcihydWxlLmZpZWxkICsgJ+S4uuW/heS8oOmhuScpKQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgY2FsbGJhY2soKQ0KICAgICAgfQ0KICAgIH0NCiAgICBjb25zdCB2YWxpZGF0ZVNvdXJjZVVyaSA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsNCiAgICAgIGlmICh2YWx1ZSkgew0KICAgICAgICBpZiAodmFsaWRVUkwodmFsdWUpKSB7DQogICAgICAgICAgY2FsbGJhY2soKQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgbWVzc2FnZTogJ+WklumTvnVybOWhq+WGmeS4jeato+ehricsDQogICAgICAgICAgICB0eXBlOiAnZXJyb3InDQogICAgICAgICAgfSkNCiAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+WklumTvnVybOWhq+WGmeS4jeato+ehricpKQ0KICAgICAgICB9DQogICAgICB9IGVsc2Ugew0KICAgICAgICBjYWxsYmFjaygpDQogICAgICB9DQogICAgfQ0KICAgIHJldHVybiB7DQogICAgICBwb3N0Rm9ybTogT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdEZvcm0pLA0KICAgICAgbG9hZGluZzogZmFsc2UsDQogICAgICB1c2VyTGlzdE9wdGlvbnM6IFtdLA0KICAgICAgcnVsZXM6IHsNCiAgICAgICAgaW1hZ2VfdXJpOiBbeyB2YWxpZGF0b3I6IHZhbGlkYXRlUmVxdWlyZSB9XSwNCiAgICAgICAgdGl0bGU6IFt7IHZhbGlkYXRvcjogdmFsaWRhdGVSZXF1aXJlIH1dLA0KICAgICAgICBjb250ZW50OiBbeyB2YWxpZGF0b3I6IHZhbGlkYXRlUmVxdWlyZSB9XSwNCiAgICAgICAgc291cmNlX3VyaTogW3sgdmFsaWRhdG9yOiB2YWxpZGF0ZVNvdXJjZVVyaSwgdHJpZ2dlcjogJ2JsdXInIH1dDQogICAgICB9LA0KICAgICAgdGVtcFJvdXRlOiB7fQ0KICAgIH0NCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICBjb250ZW50U2hvcnRMZW5ndGgoKSB7DQogICAgICByZXR1cm4gdGhpcy5wb3N0Rm9ybS5jb250ZW50X3Nob3J0Lmxlbmd0aA0KICAgIH0sDQogICAgZGlzcGxheVRpbWU6IHsNCiAgICAgIC8vIHNldCBhbmQgZ2V0IGlzIHVzZWZ1bCB3aGVuIHRoZSBkYXRhDQogICAgICAvLyByZXR1cm5lZCBieSB0aGUgYmFjayBlbmQgYXBpIGlzIGRpZmZlcmVudCBmcm9tIHRoZSBmcm9udCBlbmQNCiAgICAgIC8vIGJhY2sgZW5kIHJldHVybiA9PiAiMjAxMy0wNi0yNSAwNjo1OToyNSINCiAgICAgIC8vIGZyb250IGVuZCBuZWVkIHRpbWVzdGFtcCA9PiAxMzcyMTE0NzY1MDAwDQogICAgICBnZXQoKSB7DQogICAgICAgIHJldHVybiAoK25ldyBEYXRlKHRoaXMucG9zdEZvcm0uZGlzcGxheV90aW1lKSkNCiAgICAgIH0sDQogICAgICBzZXQodmFsKSB7DQogICAgICAgIHRoaXMucG9zdEZvcm0uZGlzcGxheV90aW1lID0gbmV3IERhdGUodmFsKQ0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICBpZiAodGhpcy5pc0VkaXQpIHsNCiAgICAgIGNvbnN0IGlkID0gdGhpcy4kcm91dGUucGFyYW1zICYmIHRoaXMuJHJvdXRlLnBhcmFtcy5pZA0KICAgICAgdGhpcy5mZXRjaERhdGEoaWQpDQogICAgfQ0KDQogICAgLy8gV2h5IG5lZWQgdG8gbWFrZSBhIGNvcHkgb2YgdGhpcy4kcm91dGUgaGVyZT8NCiAgICAvLyBCZWNhdXNlIGlmIHlvdSBlbnRlciB0aGlzIHBhZ2UgYW5kIHF1aWNrbHkgc3dpdGNoIHRhZywgbWF5IGJlIGluIHRoZSBleGVjdXRpb24gb2YgdGhlIHNldFRhZ3NWaWV3VGl0bGUgZnVuY3Rpb24sIHRoaXMuJHJvdXRlIGlzIG5vIGxvbmdlciBwb2ludGluZyB0byB0aGUgY3VycmVudCBwYWdlDQogICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL1BhbkppYUNoZW4vdnVlLWVsZW1lbnQtYWRtaW4vaXNzdWVzLzEyMjENCiAgICB0aGlzLnRlbXBSb3V0ZSA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuJHJvdXRlKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgZmV0Y2hEYXRhKGlkKSB7DQogICAgICBmZXRjaEFydGljbGUoaWQpLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICB0aGlzLnBvc3RGb3JtID0gcmVzcG9uc2UuZGF0YQ0KDQogICAgICAgIC8vIGp1c3QgZm9yIHRlc3QNCiAgICAgICAgdGhpcy5wb3N0Rm9ybS50aXRsZSArPSBgICAgQXJ0aWNsZSBJZDoke3RoaXMucG9zdEZvcm0uaWR9YA0KICAgICAgICB0aGlzLnBvc3RGb3JtLmNvbnRlbnRfc2hvcnQgKz0gYCAgIEFydGljbGUgSWQ6JHt0aGlzLnBvc3RGb3JtLmlkfWANCg0KICAgICAgICAvLyBzZXQgdGFnc3ZpZXcgdGl0bGUNCiAgICAgICAgdGhpcy5zZXRUYWdzVmlld1RpdGxlKCkNCg0KICAgICAgICAvLyBzZXQgcGFnZSB0aXRsZQ0KICAgICAgICB0aGlzLnNldFBhZ2VUaXRsZSgpDQogICAgICB9KS5jYXRjaChlcnIgPT4gew0KICAgICAgICBjb25zb2xlLmxvZyhlcnIpDQogICAgICB9KQ0KICAgIH0sDQogICAgc2V0VGFnc1ZpZXdUaXRsZSgpIHsNCiAgICAgIGNvbnN0IHRpdGxlID0gJ0VkaXQgQXJ0aWNsZScNCiAgICAgIGNvbnN0IHJvdXRlID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy50ZW1wUm91dGUsIHsgdGl0bGU6IGAke3RpdGxlfS0ke3RoaXMucG9zdEZvcm0uaWR9YCB9KQ0KICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3RhZ3NWaWV3L3VwZGF0ZVZpc2l0ZWRWaWV3Jywgcm91dGUpDQogICAgfSwNCiAgICBzZXRQYWdlVGl0bGUoKSB7DQogICAgICBjb25zdCB0aXRsZSA9ICdFZGl0IEFydGljbGUnDQogICAgICBkb2N1bWVudC50aXRsZSA9IGAke3RpdGxlfSAtICR7dGhpcy5wb3N0Rm9ybS5pZH1gDQogICAgfSwNCiAgICBzdWJtaXRGb3JtKCkgew0KICAgICAgY29uc29sZS5sb2codGhpcy5wb3N0Rm9ybSkNCiAgICAgIHRoaXMuJHJlZnMucG9zdEZvcm0udmFsaWRhdGUodmFsaWQgPT4gew0KICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlDQogICAgICAgICAgdGhpcy4kbm90aWZ5KHsNCiAgICAgICAgICAgIHRpdGxlOiAn5oiQ5YqfJywNCiAgICAgICAgICAgIG1lc3NhZ2U6ICflj5HluIPmlofnq6DmiJDlip8nLA0KICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLA0KICAgICAgICAgICAgZHVyYXRpb246IDIwMDANCiAgICAgICAgICB9KQ0KICAgICAgICAgIHRoaXMucG9zdEZvcm0uc3RhdHVzID0gJ3B1Ymxpc2hlZCcNCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnJvciBzdWJtaXQhIScpDQogICAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICBkcmFmdEZvcm0oKSB7DQogICAgICBpZiAodGhpcy5wb3N0Rm9ybS5jb250ZW50Lmxlbmd0aCA9PT0gMCB8fCB0aGlzLnBvc3RGb3JtLnRpdGxlLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICBtZXNzYWdlOiAn6K+35aGr5YaZ5b+F6KaB55qE5qCH6aKY5ZKM5YaF5a65JywNCiAgICAgICAgICB0eXBlOiAnd2FybmluZycNCiAgICAgICAgfSkNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgbWVzc2FnZTogJ+S/neWtmOaIkOWKnycsDQogICAgICAgIHR5cGU6ICdzdWNjZXNzJywNCiAgICAgICAgc2hvd0Nsb3NlOiB0cnVlLA0KICAgICAgICBkdXJhdGlvbjogMTAwMA0KICAgICAgfSkNCiAgICAgIHRoaXMucG9zdEZvcm0uc3RhdHVzID0gJ2RyYWZ0Jw0KICAgIH0sDQogICAgZ2V0UmVtb3RlVXNlckxpc3QocXVlcnkpIHsNCiAgICAgIHNlYXJjaFVzZXIocXVlcnkpLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICBpZiAoIXJlc3BvbnNlLmRhdGEuaXRlbXMpIHJldHVybg0KICAgICAgICB0aGlzLnVzZXJMaXN0T3B0aW9ucyA9IHJlc3BvbnNlLmRhdGEuaXRlbXMubWFwKHYgPT4gdi5uYW1lKQ0KICAgICAgfSkNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["ArticleDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ArticleDetail.vue","sourceRoot":"src/views/example/components","sourcesContent":["<template>\r\n  <div class=\"createPost-container\">\r\n    <el-form ref=\"postForm\" :model=\"postForm\" :rules=\"rules\" class=\"form-container\">\r\n\r\n      <sticky :z-index=\"10\" :class-name=\"'sub-navbar '+postForm.status\">\r\n        <CommentDropdown v-model=\"postForm.comment_disabled\" />\r\n        <PlatformDropdown v-model=\"postForm.platforms\" />\r\n        <SourceUrlDropdown v-model=\"postForm.source_uri\" />\r\n        <el-button v-loading=\"loading\" style=\"margin-left: 10px;\" type=\"success\" @click=\"submitForm\">\r\n          Publish\r\n        </el-button>\r\n        <el-button v-loading=\"loading\" type=\"warning\" @click=\"draftForm\">\r\n          Draft\r\n        </el-button>\r\n      </sticky>\r\n\r\n      <div class=\"createPost-main-container\">\r\n        <el-row>\r\n          <Warning />\r\n\r\n          <el-col :span=\"24\">\r\n            <el-form-item style=\"margin-bottom: 40px;\" prop=\"title\">\r\n              <MDinput v-model=\"postForm.title\" :maxlength=\"100\" name=\"name\" required>\r\n                Title\r\n              </MDinput>\r\n            </el-form-item>\r\n\r\n            <div class=\"postInfo-container\">\r\n              <el-row>\r\n                <el-col :span=\"8\">\r\n                  <el-form-item label-width=\"60px\" label=\"Author:\" class=\"postInfo-container-item\">\r\n                    <el-select v-model=\"postForm.author\" :remote-method=\"getRemoteUserList\" filterable default-first-option remote placeholder=\"Search user\">\r\n                      <el-option v-for=\"(item,index) in userListOptions\" :key=\"item+index\" :label=\"item\" :value=\"item\" />\r\n                    </el-select>\r\n                  </el-form-item>\r\n                </el-col>\r\n\r\n                <el-col :span=\"10\">\r\n                  <el-form-item label-width=\"120px\" label=\"Publish Time:\" class=\"postInfo-container-item\">\r\n                    <el-date-picker v-model=\"displayTime\" type=\"datetime\" format=\"yyyy-MM-dd HH:mm:ss\" placeholder=\"Select date and time\" />\r\n                  </el-form-item>\r\n                </el-col>\r\n\r\n                <el-col :span=\"6\">\r\n                  <el-form-item label-width=\"90px\" label=\"Importance:\" class=\"postInfo-container-item\">\r\n                    <el-rate\r\n                      v-model=\"postForm.importance\"\r\n                      :max=\"3\"\r\n                      :colors=\"['#99A9BF', '#F7BA2A', '#FF9900']\"\r\n                      :low-threshold=\"1\"\r\n                      :high-threshold=\"3\"\r\n                      style=\"display:inline-block\"\r\n                    />\r\n                  </el-form-item>\r\n                </el-col>\r\n              </el-row>\r\n            </div>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-form-item style=\"margin-bottom: 40px;\" label-width=\"70px\" label=\"Summary:\">\r\n          <el-input v-model=\"postForm.content_short\" :rows=\"1\" type=\"textarea\" class=\"article-textarea\" autosize placeholder=\"Please enter the content\" />\r\n          <span v-show=\"contentShortLength\" class=\"word-counter\">{{ contentShortLength }}words</span>\r\n        </el-form-item>\r\n\r\n        <el-form-item prop=\"content\" style=\"margin-bottom: 30px;\">\r\n          <Tinymce ref=\"editor\" v-model=\"postForm.content\" :height=\"400\" />\r\n        </el-form-item>\r\n\r\n        <el-form-item prop=\"image_uri\" style=\"margin-bottom: 30px;\">\r\n          <Upload v-model=\"postForm.image_uri\" />\r\n        </el-form-item>\r\n      </div>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Tinymce from '@/components/Tinymce'\r\nimport Upload from '@/components/Upload/SingleImage3'\r\nimport MDinput from '@/components/MDinput'\r\nimport Sticky from '@/components/Sticky' // 粘性header组件\r\nimport { validURL } from '@/utils/validate'\r\nimport { fetchArticle } from '@/api/article'\r\nimport { searchUser } from '@/api/remote-search'\r\nimport Warning from './Warning'\r\nimport { CommentDropdown, PlatformDropdown, SourceUrlDropdown } from './Dropdown'\r\n\r\nconst defaultForm = {\r\n  status: 'draft',\r\n  title: '', // 文章题目\r\n  content: '', // 文章内容\r\n  content_short: '', // 文章摘要\r\n  source_uri: '', // 文章外链\r\n  image_uri: '', // 文章图片\r\n  display_time: undefined, // 前台展示时间\r\n  id: undefined,\r\n  platforms: ['a-platform'],\r\n  comment_disabled: false,\r\n  importance: 0\r\n}\r\n\r\nexport default {\r\n  name: 'ArticleDetail',\r\n  components: { Tinymce, MDinput, Upload, Sticky, Warning, CommentDropdown, PlatformDropdown, SourceUrlDropdown },\r\n  props: {\r\n    isEdit: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  data() {\r\n    const validateRequire = (rule, value, callback) => {\r\n      if (value === '') {\r\n        this.$message({\r\n          message: rule.field + '为必传项',\r\n          type: 'error'\r\n        })\r\n        callback(new Error(rule.field + '为必传项'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    const validateSourceUri = (rule, value, callback) => {\r\n      if (value) {\r\n        if (validURL(value)) {\r\n          callback()\r\n        } else {\r\n          this.$message({\r\n            message: '外链url填写不正确',\r\n            type: 'error'\r\n          })\r\n          callback(new Error('外链url填写不正确'))\r\n        }\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    return {\r\n      postForm: Object.assign({}, defaultForm),\r\n      loading: false,\r\n      userListOptions: [],\r\n      rules: {\r\n        image_uri: [{ validator: validateRequire }],\r\n        title: [{ validator: validateRequire }],\r\n        content: [{ validator: validateRequire }],\r\n        source_uri: [{ validator: validateSourceUri, trigger: 'blur' }]\r\n      },\r\n      tempRoute: {}\r\n    }\r\n  },\r\n  computed: {\r\n    contentShortLength() {\r\n      return this.postForm.content_short.length\r\n    },\r\n    displayTime: {\r\n      // set and get is useful when the data\r\n      // returned by the back end api is different from the front end\r\n      // back end return => \"2013-06-25 06:59:25\"\r\n      // front end need timestamp => 1372114765000\r\n      get() {\r\n        return (+new Date(this.postForm.display_time))\r\n      },\r\n      set(val) {\r\n        this.postForm.display_time = new Date(val)\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    if (this.isEdit) {\r\n      const id = this.$route.params && this.$route.params.id\r\n      this.fetchData(id)\r\n    }\r\n\r\n    // Why need to make a copy of this.$route here?\r\n    // Because if you enter this page and quickly switch tag, may be in the execution of the setTagsViewTitle function, this.$route is no longer pointing to the current page\r\n    // https://github.com/PanJiaChen/vue-element-admin/issues/1221\r\n    this.tempRoute = Object.assign({}, this.$route)\r\n  },\r\n  methods: {\r\n    fetchData(id) {\r\n      fetchArticle(id).then(response => {\r\n        this.postForm = response.data\r\n\r\n        // just for test\r\n        this.postForm.title += `   Article Id:${this.postForm.id}`\r\n        this.postForm.content_short += `   Article Id:${this.postForm.id}`\r\n\r\n        // set tagsview title\r\n        this.setTagsViewTitle()\r\n\r\n        // set page title\r\n        this.setPageTitle()\r\n      }).catch(err => {\r\n        console.log(err)\r\n      })\r\n    },\r\n    setTagsViewTitle() {\r\n      const title = 'Edit Article'\r\n      const route = Object.assign({}, this.tempRoute, { title: `${title}-${this.postForm.id}` })\r\n      this.$store.dispatch('tagsView/updateVisitedView', route)\r\n    },\r\n    setPageTitle() {\r\n      const title = 'Edit Article'\r\n      document.title = `${title} - ${this.postForm.id}`\r\n    },\r\n    submitForm() {\r\n      console.log(this.postForm)\r\n      this.$refs.postForm.validate(valid => {\r\n        if (valid) {\r\n          this.loading = true\r\n          this.$notify({\r\n            title: '成功',\r\n            message: '发布文章成功',\r\n            type: 'success',\r\n            duration: 2000\r\n          })\r\n          this.postForm.status = 'published'\r\n          this.loading = false\r\n        } else {\r\n          console.log('error submit!!')\r\n          return false\r\n        }\r\n      })\r\n    },\r\n    draftForm() {\r\n      if (this.postForm.content.length === 0 || this.postForm.title.length === 0) {\r\n        this.$message({\r\n          message: '请填写必要的标题和内容',\r\n          type: 'warning'\r\n        })\r\n        return\r\n      }\r\n      this.$message({\r\n        message: '保存成功',\r\n        type: 'success',\r\n        showClose: true,\r\n        duration: 1000\r\n      })\r\n      this.postForm.status = 'draft'\r\n    },\r\n    getRemoteUserList(query) {\r\n      searchUser(query).then(response => {\r\n        if (!response.data.items) return\r\n        this.userListOptions = response.data.items.map(v => v.name)\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import \"~@/styles/mixin.scss\";\r\n\r\n.createPost-container {\r\n  position: relative;\r\n\r\n  .createPost-main-container {\r\n    padding: 40px 45px 20px 50px;\r\n\r\n    .postInfo-container {\r\n      position: relative;\r\n      @include clearfix;\r\n      margin-bottom: 10px;\r\n\r\n      .postInfo-container-item {\r\n        float: left;\r\n      }\r\n    }\r\n  }\r\n\r\n  .word-counter {\r\n    width: 40px;\r\n    position: absolute;\r\n    right: 10px;\r\n    top: 0px;\r\n  }\r\n}\r\n\r\n.article-textarea ::v-deep {\r\n  textarea {\r\n    padding-right: 40px;\r\n    resize: none;\r\n    border: none;\r\n    border-radius: 0px;\r\n    border-bottom: 1px solid #bfcbd9;\r\n  }\r\n}\r\n</style>\r\n"]}]}